name: Package
on:
  push:
    branches: [main]
jobs:
  build:
    strategy:
      matrix:
        cfg: [debug, release]
        os: [ubuntu, macos, windows]
        version: ['6.x']
    runs-on: ${{ matrix.os }}-latest
    env:
      DOTNET_NOLOGO: true
    steps:
      - name: Checkout Repository
        uses: actions/checkout@b4ffde65f46336ab88eb53be808477a3936bae11 # v4
      - name: Setup .NET Core
        uses: actions/setup-dotnet@3447fd6a9f9e57506b15f895c5b76d3b197dc7c2 # v3
        with:
          dotnet-version: '6.x'
      - name: Create Package
        id: pack
        run: >-
          dotnet pack --nologo
          --configuration ${{ matrix.cfg }}
          --version-suffix ${{ github.sha }}
      - name: Upload Package Artifact
        if: github.ref_type == 'branch'
        uses: actions/upload-artifact@a8a3f3ad30e3422c9c7b888a15615d19a852ae32 # v3
        with:
          name: ${{matrix.os}}-${{matrix.cfg}}-${{steps.pack.outputs.package-filename}}
          path: ${{steps.pack.outputs.package-filepath}}
